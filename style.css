:root{
  --bg1:#0b1020;
  --bg2:#121a2f;
  --card: rgba(255,255,255,.06);
  --card2: rgba(255,255,255,.08);
  --stroke: rgba(255,255,255,.10);
  --text: rgba(255,255,255,.92);
  --muted: rgba(255,255,255,.70);
  --muted2: rgba(255,255,255,.55);
  --accent: rgba(255, 187, 208, .95);
  --accent2: rgba(153, 231, 255, .90);
  --shadow: 0 18px 60px rgba(0,0,0,.35);
  --radius: 22px;
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
  color:var(--text);
  background: radial-gradient(1200px 600px at 15% 10%, rgba(153,231,255,.14), transparent 55%),
              radial-gradient(1000px 700px at 85% 20%, rgba(255,187,208,.12), transparent 60%),
              linear-gradient(180deg, var(--bg1), var(--bg2));
  overflow-x:hidden;
}

/* BACKGROUND */
.bg{position:fixed; inset:0; z-index:-2;}
.grain{
  position:absolute; inset:-30%;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='180' height='180' filter='url(%23n)' opacity='.18'/%3E%3C/svg%3E");
  transform:rotate(6deg);
  pointer-events:none;
  mix-blend-mode:overlay;
  animation: grainMove 8s linear infinite;
}
@keyframes grainMove{
  0%{transform:translate3d(0,0,0) rotate(6deg)}
  50%{transform:translate3d(-2%, -3%, 0) rotate(6deg)}
  100%{transform:translate3d(0,0,0) rotate(6deg)}
}
.blobs{position:absolute; inset:0; overflow:hidden;}
.blob{
  position:absolute;
  width: 520px; height: 520px;
  border-radius: 999px;
  filter: blur(28px);
  opacity:.16;
  animation: floaty 10s ease-in-out infinite;
}
.b1{left:-120px; top:-120px; background: var(--accent2);}
.b2{right:-180px; top:40px; background: var(--accent); animation-duration: 12s;}
.b3{left:20%; bottom:-220px; background: rgba(160,255,220,.6); animation-duration: 14s;}
@keyframes floaty{
  0%,100%{transform:translateY(0) translateX(0) scale(1)}
  50%{transform:translateY(26px) translateX(-18px) scale(1.03)}
}

/* Calm mode: slow background animations when duty ON */
body.calm .blob{ animation-duration: 18s !important; }
body.calm .b2{ animation-duration: 22s !important; }
body.calm .b3{ animation-duration: 26s !important; }
body.calm .grain{ animation-duration: 14s !important; }

/* LAYOUT */
.wrap{
  max-width: 1050px;
  margin: 0 auto;
  padding: 22px 16px 70px;
}
.top{
  display:flex;
  gap:14px;
  justify-content:space-between;
  align-items:flex-start;
  margin-bottom: 18px;
}
.kicker{
  font-size: 12px;
  letter-spacing:.08em;
  text-transform:uppercase;
  color: var(--muted);
}
h1{
  margin:6px 0 6px;
  font-size: 30px;
  line-height: 1.15;
}
.sub{
  margin:0;
  color: var(--muted);
  font-size: 14px;
}
.pills{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:flex-end;
}
.pill{
  border:1px solid var(--stroke);
  background: rgba(255,255,255,.06);
  color: var(--text);
  padding: 10px 12px;
  border-radius: 999px;
  cursor:pointer;
  transition: transform .12s ease, background .2s ease, border-color .2s ease;
  backdrop-filter: blur(10px);
}
.pill:hover{transform: translateY(-1px); background: rgba(255,255,255,.08);}
.pill[aria-pressed="true"]{
  border-color: rgba(255,255,255,.24);
  background: rgba(255,255,255,.11);
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns: repeat(12, 1fr);
  gap: 14px;
}
.card{
  grid-column: span 6;
  background: linear-gradient(180deg, var(--card2), var(--card));
  border:1px solid var(--stroke);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding: 16px;
  backdrop-filter: blur(12px);
  position: relative;
  overflow:hidden;
}
.cardTitle{
  font-weight: 700;
  margin-bottom: 10px;
  letter-spacing:.02em;
}
.hero{grid-column: span 12; padding: 18px;}
.heroTop{
  display:flex; justify-content:space-between; gap:10px; align-items:center;
  margin-bottom: 10px;
}
.badge{
  border:1px solid var(--stroke);
  background: rgba(255,255,255,.08);
  padding: 8px 10px;
  border-radius: 999px;
  font-size: 12px;
  color: var(--text);
}
.badge.soft{color: var(--muted);}
.heroBody .big{
  font-size: 22px;
  font-weight: 800;
  margin: 6px 0 6px;
}
.hint{color: var(--muted); font-size: 14px; margin-bottom: 12px;}

/* HEART */
.heartRow{
  display:flex;
  align-items:center;
  gap:10px;
  margin: 6px 0 10px;
  color: rgba(255,255,255,.78);
}
.heart{
  display:inline-flex;
  width: 26px; height: 26px;
  align-items:center; justify-content:center;
  border-radius: 999px;
  background: rgba(255,187,208,.18);
  border: 1px solid rgba(255,255,255,.10);
  transform: translateZ(0);
  opacity: .88;
}
.heartText{
  font-size: 12px;
  color: rgba(255,255,255,.62);
  letter-spacing:.02em;
}
.heart.beat{
  animation: heartBeat 1.35s ease-in-out infinite;
}
@keyframes heartBeat{
  0%,100%{ transform: scale(1); }
  25%{ transform: scale(1.08); }
  45%{ transform: scale(1); }
  60%{ transform: scale(1.05); }
  78%{ transform: scale(1); }
}

/* BUTTONS */
.row{
  display:flex; gap:10px; flex-wrap:wrap;
  margin-top: 6px;
}
.btn{
  appearance:none;
  border:1px solid var(--stroke);
  background: rgba(255,255,255,.06);
  color: var(--text);
  padding: 10px 12px;
  border-radius: 14px;
  cursor:pointer;
  transition: transform .12s ease, background .2s ease, border-color .2s ease;
  text-decoration:none;
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:8px;
}
.btn:hover{transform: translateY(-1px); background: rgba(255,255,255,.08);}
.btn.primary{
  border-color: rgba(255,255,255,.20);
  background: linear-gradient(90deg, rgba(255,187,208,.28), rgba(153,231,255,.22));
}
.btn:active{transform: translateY(0px) scale(.99);}

.btn.good{ border-color: rgba(140,255,196,.22); background: rgba(140,255,196,.10); }
.btn.warn{ border-color: rgba(255,205,140,.22); background: rgba(255,205,140,.10); }
.btn.soft{ border-color: rgba(255,255,255,.14); background: rgba(255,255,255,.06); }

.tiny{color: var(--muted2); font-size: 12px; margin-top: 10px;}
.smallmuted{color: var(--muted); font-size: 13px; line-height:1.45;}
.divider{
  height:1px;
  background: rgba(255,255,255,.10);
  margin: 12px 0;
}

/* WEATHER */
.wx{display:flex; gap:12px; justify-content:space-between; align-items:center; flex-wrap:wrap;}
.wxTemp{font-size: 28px; font-weight: 900;}
.wxMeta{color: var(--muted); font-size: 13px;}
.wxRight{display:flex; gap:10px; flex-wrap:wrap; justify-content:flex-end;}
.wxChip{
  border:1px solid var(--stroke);
  background: rgba(255,255,255,.06);
  padding: 8px 10px;
  border-radius: 999px;
  font-size: 12px;
}
.wxChip.soft{color: var(--muted);}

/* DISTANCE */
.distance{display:flex; gap:10px; align-items:flex-end; justify-content:space-between; flex-wrap:wrap;}
.km{font-size: 34px; font-weight: 950; letter-spacing:-.02em;}
.pulse{ animation: pulseSoft .55s ease; }
@keyframes pulseSoft{
  0%{ transform: scale(1); }
  40%{ transform: scale(1.03); }
  100%{ transform: scale(1); }
}

/* MINI LIST */
.miniList{display:flex; flex-direction:column; gap:10px;}
.miniItem{display:flex; gap:10px; align-items:flex-start;}
.miniIcon{font-size: 18px; width:28px; display:flex; justify-content:center;}
.miniHead{font-weight:800; margin-bottom: 2px;}
.miniText{color: var(--muted); font-size: 13px; line-height:1.35;}

/* FOOTER */
.foot{margin-top: 16px;}
.footInner{
  display:flex; gap:8px; align-items:center; justify-content:center; flex-wrap:wrap;
  color: var(--muted2);
}
.dot{opacity:.5}

/* TOAST */
.toast{
  position: fixed;
  left: 50%;
  bottom: 18px;
  transform: translateX(-50%) translateY(18px);
  background: rgba(20, 26, 46, .85);
  border:1px solid rgba(255,255,255,.12);
  color: var(--text);
  padding: 10px 12px;
  border-radius: 14px;
  box-shadow: var(--shadow);
  opacity: 0;
  pointer-events:none;
  transition: opacity .18s ease, transform .18s ease;
  max-width: min(560px, calc(100vw - 24px));
  text-align:center;
  backdrop-filter: blur(10px);
  z-index: 50;
}
.toast.show{
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

/* SPARKLES */
.sparkles{
  position:absolute; inset:0;
  background:
    radial-gradient(12px 12px at 10% 30%, rgba(255,255,255,.22), transparent 55%),
    radial-gradient(16px 16px at 35% 70%, rgba(153,231,255,.18), transparent 60%),
    radial-gradient(12px 12px at 75% 35%, rgba(255,187,208,.18), transparent 55%),
    radial-gradient(18px 18px at 90% 75%, rgba(255,255,255,.14), transparent 60%);
  opacity:.55;
  animation: sparkle 6.5s ease-in-out infinite;
  pointer-events:none;
}
@keyframes sparkle{
  0%,100%{transform:translateY(0); opacity:.45}
  50%{transform:translateY(-6px); opacity:.65}
}
body.calm .sparkles{ animation-duration: 10.5s !important; opacity: .48; }

/* RAIN (soft) */
.rain{
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: -1;
  opacity: 0;
  transition: opacity .35s ease;
}
.rain.on{ opacity: .55; }
.rain::before{
  content:"";
  position:absolute;
  inset:-40%;
  background:
    linear-gradient(transparent, rgba(255,255,255,.14), transparent) 0 0/ 2px 18px repeat,
    linear-gradient(transparent, rgba(153,231,255,.12), transparent) 20px 10px/ 2px 22px repeat;
  transform: rotate(12deg);
  filter: blur(.2px);
  animation: rainFall 1.1s linear infinite;
  opacity: .20;
}
@keyframes rainFall{
  0%{ transform: translateY(-12%) rotate(12deg); }
  100%{ transform: translateY(12%) rotate(12deg); }
}
body.calm .rain::before{ animation-duration: 1.55s !important; opacity: .16; }

/* Equalizer */
.eq{
  position: fixed;
  top: 14px;
  right: 14px;
  width: 34px;
  height: 26px;
  border: 1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.06);
  border-radius: 12px;
  display: none;
  align-items: flex-end;
  justify-content: center;
  gap: 3px;
  padding: 6px 7px;
  backdrop-filter: blur(10px);
  box-shadow: 0 12px 40px rgba(0,0,0,.28);
  z-index: 60;
}
.eq.on{ display:flex; }
.eq span{
  width: 3px;
  height: 6px;
  border-radius: 99px;
  background: rgba(255,255,255,.70);
  transform-origin: bottom;
  animation: eqMove .65s ease-in-out infinite;
  opacity: .9;
}
.eq span:nth-child(2){ animation-delay: .10s; }
.eq span:nth-child(3){ animation-delay: .20s; }
.eq span:nth-child(4){ animation-delay: .30s; }
@keyframes eqMove{
  0%,100%{ transform: scaleY(.45); opacity:.65; }
  50%{ transform: scaleY(1.35); opacity:.95; }
}
body.calm .eq span{ animation-duration: .95s !important; }

/* PAGE ENTER: cards animate in */
.page-enter .card{
  opacity: 0;
  transform: translateY(10px) scale(.995);
  animation: cardIn .55s ease forwards;
}
.page-enter .card:nth-child(1){ animation-delay: .02s; }
.page-enter .card:nth-child(2){ animation-delay: .10s; }
.page-enter .card:nth-child(3){ animation-delay: .16s; }
.page-enter .card:nth-child(4){ animation-delay: .22s; }
.page-enter .card:nth-child(5){ animation-delay: .28s; }
@keyframes cardIn{
  to { opacity: 1; transform: translateY(0) scale(1); }
}

/* MOBILE */
@media (max-width: 860px){
  .top{flex-direction:column; align-items:flex-start;}
  .pills{justify-content:flex-start;}
  .card{grid-column: span 12;}
  h1{font-size: 28px;}
}

/* Respect reduced motion */
@media (prefers-reduced-motion: reduce){
  .blob, .grain, .sparkles, .eq span, .page-enter .card, .pulse, .rain::before, .heart.beat{
    animation: none !important;
  }
}
